



<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>6. Cómo simbolizarlas - Trabajando con VT</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#como-simbolizar-teselas-vectoriales" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Trabajando con VT" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Trabajando con VT
              </span>
              <span class="md-header-nav__topic">
                6. Cómo simbolizarlas
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/geoinquiets/taller-vt/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Trabajando con VT" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Trabajando con VT
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/geoinquiets/taller-vt/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../1_teoria/" title="1. Qué son" class="md-nav__link">
      1. Qué son
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../2_visor_simple/" title="2. Cómo visualizarlas" class="md-nav__link">
      2. Cómo visualizarlas
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../3_tileserver_gl/" title="3. Cómo servirlas" class="md-nav__link">
      3. Cómo servirlas
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../4_tippecanoe/" title="4. Cómo crearlas" class="md-nav__link">
      4. Cómo crearlas
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../5_sprites_glyphs/" title="5. Sprites y Glyphs" class="md-nav__link">
      5. Sprites y Glyphs
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        6. Cómo simbolizarlas
      </label>
    
    <a href="./" title="6. Cómo simbolizarlas" class="md-nav__link md-nav__link--active">
      6. Cómo simbolizarlas
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#maputnik" title="Maputnik" class="md-nav__link">
    Maputnik
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion" title="Instalación" class="md-nav__link">
    Instalación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comenzar-un-estilo-nuevo" title="Comenzar un estilo nuevo" class="md-nav__link">
    Comenzar un estilo nuevo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agregar-un-origen-de-datos-source" title="Agregar un origen de datos (Source)" class="md-nav__link">
    Agregar un origen de datos (Source)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agregar-sprite-y-glyphs" title="Agregar sprite y glyphs" class="md-nav__link">
    Agregar sprite y glyphs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simbolizacion-basica" title="Simbolización básica" class="md-nav__link">
    Simbolización básica
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fondo" title="Fondo" class="md-nav__link">
    Fondo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oceanos" title="Océanos" class="md-nav__link">
    Océanos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resto-de-capas-basicas" title="Resto de capas básicas" class="md-nav__link">
    Resto de capas básicas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filtrar-los-datos-a-mostrar-en-una-capa" title="Filtrar los datos a mostrar en una capa" class="md-nav__link">
    Filtrar los datos a mostrar en una capa
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-extra" title="Ejercicio extra" class="md-nav__link">
    Ejercicio extra
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etiquetar-una-capa" title="Etiquetar una capa" class="md-nav__link">
    Etiquetar una capa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilizar-un-icono-para-simbolizar-nuestra-capa" title="Utilizar un icono para simbolizar nuestra capa" class="md-nav__link">
    Utilizar un icono para simbolizar nuestra capa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exportar-el-estilo-creado" title="Exportar el estilo creado" class="md-nav__link">
    Exportar el estilo creado
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edicion-manual-del-estilo" title="Edición manual del estilo" class="md-nav__link">
    Edición manual del estilo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crear-un-visor-para-el-nuevo-estilo" title="Crear un visor para el nuevo estilo" class="md-nav__link">
    Crear un visor para el nuevo estilo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilo-avanzado-basado-en-expresiones" title="Estilo avanzado basado en expresiones" class="md-nav__link">
    Estilo avanzado basado en expresiones
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estilo-basado-en-valores-concretos-de-una-propiedad" title="Estilo basado en valores concretos de una propiedad" class="md-nav__link">
    Estilo basado en valores concretos de una propiedad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilo-basado-en-el-nivel-del-zoom" title="Estilo basado en el nivel del zoom" class="md-nav__link">
    Estilo basado en el nivel del zoom
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilo-basado-en-una-propiedad" title="Estilo basado en una propiedad" class="md-nav__link">
    Estilo basado en una propiedad
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uso-de-fuentes-de-datos-externas" title="Uso de fuentes de datos externas" class="md-nav__link">
    Uso de fuentes de datos externas
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-extra-uso-de-una-fuente-con-iconos-para-simbolizar-un-punto" title="Ejercicio extra: uso de una fuente con iconos para simbolizar un punto" class="md-nav__link">
    Ejercicio extra: uso de una fuente con iconos para simbolizar un punto
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../7_servidor_dinamico/" title="7. Cómo servir datos dinámicos" class="md-nav__link">
      7. Cómo servir datos dinámicos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../8_postgis_vt/" title="8. Cómo servir datos desde PostGIS" class="md-nav__link">
      8. Cómo servir datos desde PostGIS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../9_geoserver_vts/" title="9. Servir vector tiles desde GeoServer" class="md-nav__link">
      9. Servir vector tiles desde GeoServer
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#maputnik" title="Maputnik" class="md-nav__link">
    Maputnik
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion" title="Instalación" class="md-nav__link">
    Instalación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comenzar-un-estilo-nuevo" title="Comenzar un estilo nuevo" class="md-nav__link">
    Comenzar un estilo nuevo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agregar-un-origen-de-datos-source" title="Agregar un origen de datos (Source)" class="md-nav__link">
    Agregar un origen de datos (Source)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agregar-sprite-y-glyphs" title="Agregar sprite y glyphs" class="md-nav__link">
    Agregar sprite y glyphs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simbolizacion-basica" title="Simbolización básica" class="md-nav__link">
    Simbolización básica
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fondo" title="Fondo" class="md-nav__link">
    Fondo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oceanos" title="Océanos" class="md-nav__link">
    Océanos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resto-de-capas-basicas" title="Resto de capas básicas" class="md-nav__link">
    Resto de capas básicas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filtrar-los-datos-a-mostrar-en-una-capa" title="Filtrar los datos a mostrar en una capa" class="md-nav__link">
    Filtrar los datos a mostrar en una capa
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-extra" title="Ejercicio extra" class="md-nav__link">
    Ejercicio extra
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etiquetar-una-capa" title="Etiquetar una capa" class="md-nav__link">
    Etiquetar una capa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilizar-un-icono-para-simbolizar-nuestra-capa" title="Utilizar un icono para simbolizar nuestra capa" class="md-nav__link">
    Utilizar un icono para simbolizar nuestra capa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exportar-el-estilo-creado" title="Exportar el estilo creado" class="md-nav__link">
    Exportar el estilo creado
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edicion-manual-del-estilo" title="Edición manual del estilo" class="md-nav__link">
    Edición manual del estilo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crear-un-visor-para-el-nuevo-estilo" title="Crear un visor para el nuevo estilo" class="md-nav__link">
    Crear un visor para el nuevo estilo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilo-avanzado-basado-en-expresiones" title="Estilo avanzado basado en expresiones" class="md-nav__link">
    Estilo avanzado basado en expresiones
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estilo-basado-en-valores-concretos-de-una-propiedad" title="Estilo basado en valores concretos de una propiedad" class="md-nav__link">
    Estilo basado en valores concretos de una propiedad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilo-basado-en-el-nivel-del-zoom" title="Estilo basado en el nivel del zoom" class="md-nav__link">
    Estilo basado en el nivel del zoom
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilo-basado-en-una-propiedad" title="Estilo basado en una propiedad" class="md-nav__link">
    Estilo basado en una propiedad
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uso-de-fuentes-de-datos-externas" title="Uso de fuentes de datos externas" class="md-nav__link">
    Uso de fuentes de datos externas
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-extra-uso-de-una-fuente-con-iconos-para-simbolizar-un-punto" title="Ejercicio extra: uso de una fuente con iconos para simbolizar un punto" class="md-nav__link">
    Ejercicio extra: uso de una fuente con iconos para simbolizar un punto
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/geoinquiets/taller-vt/edit/master/docs/6_estilos.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="como-simbolizar-teselas-vectoriales">Cómo simbolizar teselas vectoriales</h1>
<h2 id="maputnik">Maputnik</h2>
<p>Es un editor visual gratuito y abierto para estilos Mapbox GL dirigidos tanto a desarrolladores
como a diseñadores de mapas.</p>
<p>Se puede utilizar en línea en <a href="https://maputnik.github.io/editor/"><em>Maputnik editor</em></a> o se puede
hacer una instalación local.</p>
<h3 id="instalacion">Instalación</h3>
<p>Se puede descargar la última versión de la <a href="https://github.com/maputnik/editor/releases"><em>página de releases</em></a>.
En nuestro caso, la tenemos ya descargada en <code>~/Desktop/taller-vt/maputnik</code>.</p>
<p>Para arrancar la versión local:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">cd</span> ~/Desktop/taller-vt/maputnik
live-server --port<span class="o">=</span><span class="m">8082</span>
</pre></div>
</td></tr></table>

<p>Abrir Maputnik en <a href="http://localhost:8082">http://localhost:8082</a></p>
<p><img alt="Maputnik" src="../img/maputnik.png" /></p>
<h3 id="comenzar-un-estilo-nuevo">Comenzar un estilo nuevo</h3>
<p>En la barra de menú seleccionamos la opción <strong>Open</strong>.
Del apartado <strong>Gallery Styles</strong>, seleccionamos <strong>Empty Style</strong>.</p>
<h3 id="agregar-un-origen-de-datos-source">Agregar un origen de datos (Source)</h3>
<p>En la barra de menú seleccionamos la opción <strong>Sources</strong>.
En la parte inferior del diálogo está la sección: <strong>Add New Source</strong>.</p>
<p><img alt="Maputnik Add Source" src="../img/maputnik_add_source.png" /></p>
<ul>
<li>Como <code>Source ID</code> ponemos <code>naturalearth</code>.</li>
<li>Como <code>Source Type</code> seleccionamos <code>Vector (TileJSON URL)</code>.</li>
<li>Como <code>TileJSON URL</code> seleccionamos <code>http://localhost:8081/data/natural_earth.json</code></li>
</ul>
<p>También se podría usar como <code>Source Type</code> un <code>Vector (XYZ URL)</code>, en cuyo caso también hay que
indicar el rango de zooms en que los datos son válidos.</p>
<h3 id="agregar-sprite-y-glyphs">Agregar sprite y glyphs</h3>
<p>En la barra de menú seleccionamos <strong>Style Settings</strong>:</p>
<p><img alt="Maputnik Style Settings" src="../img/maputnik_style_settings.png" /></p>
<ul>
<li><code>Name</code>: Nombre del estilo. En nuestro caso pondremos <code>Natural Earth</code>.</li>
<li><code>Sprite URL</code>: Usaremos el sprite de uno de los estilos que tenemos publicados en tileserver <code>http://localhost:8081/styles/osm-bright/sprite</code></li>
<li><code>Glyphs URL</code>: Accederemos a las tipografías publicadas en nuestro Tileserver <code>http://localhost:8081/fonts/{fontstack}/{range}.pbf</code></li>
</ul>
<h3 id="simbolizacion-basica">Simbolización básica</h3>
<p>Presionamos el botón de <strong>Add Layer</strong>: </p>
<p><img alt="Maputnik Add Layer" src="../img/maputnik_add_layer.png" /></p>
<h4 id="fondo">Fondo</h4>
<p>Añadimos una primera capa de fondo:</p>
<ul>
<li><code>ID</code>: identificador único de la capa. Pondremos <code>fondo</code>.</li>
<li><code>Type</code>: tipo de capa. Seleccionar la opción de <code>Background</code>.</li>
</ul>
<p>Seleccionamos el color en <strong>Paint properties</strong> =&gt; <strong>Color</strong>: "#F8F4F0".</p>
<p>El fondo del mapa pasa a un gris claro.</p>
<h4 id="oceanos">Océanos</h4>
<p>Añadimos ahora los océanos: </p>
<ul>
<li><code>ID</code>: identificador único de la capa. Pondremos <code>oceanos</code>.</li>
<li><code>Type</code>: tipo de capa. Seleccionar la opción de <code>Fill</code> ya que la capa es de tipo polígono.</li>
<li><code>Source</code>: identificador del origen de datos. En nuestro caso pondremos <code>naturalearth</code>.</li>
<li><code>Source Layer</code>: identificador de la capa dentro del origen de datos. Pondremos <code>ocean</code>.</li>
</ul>
<p>Aparecerán los océanos de color negro.</p>
<p>Simbolizamos la capa seleccionando un color RGB en <strong>Paint properties</strong> =&gt; <strong>Color</strong>: "#A0C8F0".</p>
<p>En el apartado inferior del panel de propiedades de la capa, vamos viendo la definición tal
como se guardará en el fichero json de estilo:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;oceanos&quot;</span><span class="p">,</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;naturalearth&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;ocean&quot;</span><span class="p">,</span>
  <span class="nt">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#A0C8F0&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Maputnik no es más que un asistente gráfico para generar el fichero <code>style.json</code>. </p>
<h4 id="resto-de-capas-basicas">Resto de capas básicas</h4>
<p>El resto de capas se puede simbolizar procediendo de la misma manera: </p>
<table>
<thead>
<tr>
<th>id</th>
<th>type</th>
<th>source-layer</th>
<th>color</th>
<th>otras propiedades "paint"</th>
</tr>
</thead>
<tbody>
<tr>
<td>fondo</td>
<td>Background</td>
<td>--</td>
<td><code>#F8F4F0</code></td>
<td>--</td>
</tr>
<tr>
<td>oceanos</td>
<td>Fill</td>
<td>ocean</td>
<td><code>#A0C8F0</code></td>
<td>--</td>
</tr>
<tr>
<td>tierra</td>
<td>Fill</td>
<td>land</td>
<td><code>#E6C7C7</code></td>
<td>--</td>
</tr>
<tr>
<td>costa</td>
<td>Line</td>
<td>coastline</td>
<td><code>#4793E8</code></td>
<td>--</td>
</tr>
<tr>
<td>rios</td>
<td>Line</td>
<td>rivers</td>
<td><code>#4793E8</code></td>
<td>--</td>
</tr>
<tr>
<td>lagos</td>
<td>Fill</td>
<td>lakes</td>
<td><code>#A0C8F0</code></td>
<td>Outline color: <code>#4793E8</code></td>
</tr>
<tr>
<td>ferrocarril</td>
<td>Line</td>
<td>rail</td>
<td><code>#707070</code></td>
<td>--</td>
</tr>
<tr>
<td>carreteras</td>
<td>Line</td>
<td>roads</td>
<td><code>#BF5757</code></td>
<td>--</td>
</tr>
</tbody>
</table>
<p><img alt="Maputnik Add Filter" src="../img/maputnik_mapa_base.png" /></p>
<h3 id="filtrar-los-datos-a-mostrar-en-una-capa">Filtrar los datos a mostrar en una capa</h3>
<p>Vamos a eliminar las rutas de ferry que se muestran como carreteras.</p>
<p>Hay dos maneras de definir un filtro en un estilo MapboxGL:</p>
<ol>
<li><strong>Filters</strong>: La forma clásica, que implementa Maputnik: <a href="https://www.mapbox.com/mapbox-gl-js/style-spec/#other-filter">https://www.mapbox.com/mapbox-gl-js/style-spec/#other-filter</a></li>
<li><strong>Decision Expressions</strong>: La nueva forma, más potente, pero que Maputnik no implementa: <a href="https://www.mapbox.com/mapbox-gl-js/style-spec/#expressions-decision">https://www.mapbox.com/mapbox-gl-js/style-spec/#expressions-decision</a></li>
</ol>
<p>Ahora aprenderemos a crear un <strong>Filter</strong> con Maputnik, y más adelante aplicaremos <strong>Expressions</strong> directamente sobre el fichero json de estilo.</p>
<p>En Maputnik, seleccionando la capa <code>carreteras</code>, apartado <strong>Filter</strong>: Presionamos el botón <strong>Add filter</strong>.
La condición será:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    featurecla == Road
</pre></div>
</td></tr></table>

<p><img alt="Maputnik Add Filter" src="../img/maputnik_add_filter.png" /></p>
<p>Comprobar que desaparecen las líneas de Ferry en el mapa.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Usa el <strong>Inspect Mode</strong> integrado en Maputnik para explorar los diferentes campos de una capa y sus posibles valores.</p>
</div>
<h4 id="ejercicio-extra">Ejercicio extra</h4>
<p>Crea una nueva capa "ferrys" y aplica el filtro contrario para mostrar sólo las rutas de ferry.
Investiga la propiedad <code>Dasharray</code> para darle un aspecto de línea discontinua a las rutas.</p>
<p><img alt="Maputnik Ferries" src="../img/maputnik_ferries.png" /></p>
<h3 id="etiquetar-una-capa">Etiquetar una capa</h3>
<ol>
<li>
<p>Agregar la capa de ciudades. Presionar el botón de <strong>Add Layer</strong> y rellenar el formulario con
la siguiente información:</p>
<ul>
<li><code>ID</code>: <code>ciudades</code></li>
<li><code>Type</code>: <code>Symbol</code>, utilizado para mostrar entidades puntuales (iconos y etiquetas)</li>
<li><code>Source</code>: <code>naturalearth</code></li>
<li><code>Source Layer</code>: <code>cities</code></li>
</ul>
</li>
<li>
<p>En el apartado <strong>Text layout properties</strong>:</p>
<ul>
<li>En la propiedad <code>Field</code> escribir <code>{NAME}</code> (el nombre del campo a mostrar, entre llaves).</li>
<li>En la propiedad <code>Font</code>, escribir <code>Comic Sans</code>, tipografía que hemos generado y publicado en el apartado anterior (nota: el taller sobre cómo hacer mapas bonitos es esta tarde).</li>
</ul>
</li>
</ol>
<h3 id="utilizar-un-icono-para-simbolizar-nuestra-capa">Utilizar un icono para simbolizar nuestra capa</h3>
<ol>
<li>
<p>Agregar la capa de aeropuertos. Presionar el botón de <strong>Add Layer</strong> y rellenar el formulario con
la siguiente información:</p>
<ul>
<li><code>ID</code>: <code>aeropuertos</code></li>
<li><code>Type</code>: <code>Symbol</code>, utilizado para mostrar entidades puntuales (iconos y etiquetas)</li>
<li><code>Source</code>: <code>naturalearth</code></li>
<li><code>Source Layer</code>: <code>airports</code></li>
</ul>
</li>
<li>
<p>En el apartado de <strong>Icon layout properties</strong>:</p>
<ul>
<li>En la propiedad <code>Image</code>, escribir <code>airport_11</code>. Este nombre debe coincidir con alguna imagen definida en el sprite.</li>
</ul>
</li>
<li>
<p>Comprobar que aparecen los aeropuertos en el mapa.</p>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Estos son los iconos del sprite del estilo (<code>osm-bright</code>) que estamos utilizando:
<a href="https://github.com/openmaptiles/osm-bright-gl-style/tree/master/icons">https://github.com/openmaptiles/osm-bright-gl-style/tree/master/icons</a></p>
</div>
<h3 id="exportar-el-estilo-creado">Exportar el estilo creado</h3>
<p>Seleccionar la opción <strong>Export</strong>, y luego el boton de <strong>Download</strong> para descargar el estilo en nuestro ordenador.
Descargamos el archivo, lo renombramos a <code>style.json</code> y lo movemos a la carpeta <code>tileserver/styles/natural-earth/</code>,
donde ya habíamos copiado los sprites generados en el apartado anterior.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>cp ~/Downloads/xxxxxx.json ~/Desktop/taller-vt/tileserver/styles/natural-earth/style.json
</pre></div>
</td></tr></table>

<p>Habrá que editar el fichero de configuración de tileserver <code>tileserver/config.json</code> para añadir el estilo: </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="s2">&quot;styles&quot;</span><span class="err">:</span> <span class="p">{</span>
    <span class="nt">&quot;klokantech-basic&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;klokantech-basic/style.json&quot;</span><span class="p">,</span>
        <span class="nt">&quot;tilejson&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;bounds&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.898</span><span class="p">,</span> <span class="mf">41.246</span><span class="p">,</span> <span class="mf">2.312</span><span class="p">,</span> <span class="mf">41.533</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;osm-bright&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;osm-bright/style.json&quot;</span><span class="p">,</span>
        <span class="nt">&quot;tilejson&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;bounds&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.898</span><span class="p">,</span> <span class="mf">41.246</span><span class="p">,</span> <span class="mf">2.312</span><span class="p">,</span> <span class="mf">41.533</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="hll">    <span class="nt">&quot;natural-earth&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">        <span class="nt">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;natural-earth/style.json&quot;</span>
</span><span class="hll">    <span class="p">}</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Reiniciar tileserver y comprobar que ofrece el nuevo estilo de visualización.</p>
<h2 id="edicion-manual-del-estilo">Edición manual del estilo</h2>
<p>Vamos a dejar Maputnik a un lado y vamos a editar el estilo json a mano.</p>
<h3 id="crear-un-visor-para-el-nuevo-estilo">Crear un visor para el nuevo estilo</h3>
<p>Lo primero será crear un visor para los datos y estilo de Natural Earth partiendo del visor de Barcelona.
También usaremos una copia local del estilo porque será más fácil ir viendo los cambios. Cada vez que guardemos en disco una
modificación del fichero de estilo, podremos recargar directamente la página en el navegador para reflejar los cambios.</p>
<ul>
<li>Copiar el archivo <code>visor/barcelona.html</code> en <code>visor/naturalearth.html</code></li>
<li>Además, hacer una copia de <code>tileserver/styles/natural-earth/style.json</code> en <code>visor/natural-earth-style.json</code>.</li>
</ul>
<p>Editaremos <code>visor/naturalearth.html</code> y en la parte de <code>&lt;script&gt;</code> dejaremos sólo este código:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mapboxgl</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
    <span class="nx">container</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
    <span class="nx">style</span><span class="o">:</span> <span class="s1">&#39;natural-earth-style.json&#39;</span><span class="p">,</span>
    <span class="nx">center</span><span class="o">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">41</span><span class="p">],</span>
    <span class="nx">zoom</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="nx">hash</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="k">new</span> <span class="nx">mapboxgl</span><span class="p">.</span><span class="nx">NavigationControl</span><span class="p">());</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="k">new</span> <span class="nx">MapboxInspect</span><span class="p">());</span>
</pre></div>
</td></tr></table>

<p>Abriendo en el navegador <a href="http://127.0.0.1:8080/naturalearth.html">http://127.0.0.1:8080/naturalearth.html</a> debería verse:</p>
<p><img alt="Natural Earth Viewer" src="../img/natural_earth_viewer.png" /></p>
<h3 id="estilo-avanzado-basado-en-expresiones">Estilo avanzado basado en expresiones</h3>
<p>El estilo basado en datos permite estilizar los datos en función del valor de sus propiedades.
Por ejemplo, cambiar el radio de un círculo o el color de un polígono en función de un valor
numérico, o usar lógica condicional para crear etiquetas multilingües.</p>
<p>Las <a href="https://www.mapbox.com/mapbox-gl-js/style-spec#expressions">expresiones de Mapbox GL</a> se
pueden usar en cualquier propiedad de tipo <code>layout</code>, <code>paint</code> o <code>filter</code> de una <code>layer</code>.</p>
<p>Gracias a las expresiones, una regla de simbolización determinada puede calcularse como el resultado de
un cálculo donde intervienen los valores de una o más propiedades de una <em>feature</em>. Pueden
usarse operaciones lógicas, matemáticas, de generación de color, interpolaciones, etc.</p>
<h4 id="estilo-basado-en-valores-concretos-de-una-propiedad">Estilo basado en valores concretos de una propiedad</h4>
<p>Abrir el fichero <code>natural-earth-style.json</code> y localizar el layer con id <code>carreteras</code>.</p>
<p>Vamos a asignar un color distinto en función del valor de la propiedad <code>type</code>.
Para ello usaremos la expresión <a href="https://www.mapbox.com/mapbox-gl-js/style-spec#expressions-match">Match</a>,
que asigna a cada valor de entrada un valor de salida distinto (en nuestro caso, un color para
cada tipo de carretera):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[&quot;match&quot;, &lt;propiedad&gt;,
    &lt;valorentrada_1&gt;, &lt;salida_1&gt;,
    &lt;entrada_2&gt;, &lt;salida_2&gt;,
    ...,
    &lt;salida_por_defecto&gt;
]
</pre></div>
</td></tr></table>

<p>Para obtener el valor de la propiedad de una feature se usa la expresión Get: <code>["get", &lt;nombre_propiedad&gt;]</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;carreteras&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
    <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;naturalearth&quot;</span><span class="p">,</span>
    <span class="nt">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;roads&quot;</span><span class="p">,</span>
    <span class="nt">&quot;filter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="s2">&quot;featurecla&quot;</span><span class="p">,</span> <span class="s2">&quot;Road&quot;</span><span class="p">]],</span>
    <span class="nt">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="hll">        <span class="nt">&quot;line-color&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">            <span class="s2">&quot;match&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">],</span>
</span><span class="hll">            <span class="s2">&quot;Major Highway&quot;</span><span class="p">,</span>     <span class="s2">&quot;rgba(20, 52, 232, 1)&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="s2">&quot;Secondary Highway&quot;</span><span class="p">,</span> <span class="s2">&quot;rgba(206, 32, 79, 1)&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="s2">&quot;Road&quot;</span><span class="p">,</span>              <span class="s2">&quot;rgba(49, 137, 52, 1)&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="s2">&quot;rgba(255, 204, 0, 1)&quot;</span>
</span><span class="hll">        <span class="p">],</span>
</span><span class="hll">        <span class="nt">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span>    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h4 id="estilo-basado-en-el-nivel-del-zoom">Estilo basado en el nivel del zoom</h4>
<p>Localizar el layer con id <code>ciudades</code>.</p>
<p>Vamos a cambiar el tamaño del texto según el nivel de zoom del mapa, y de la propiedad <code>SCALERANK</code> del dato.</p>
<p>Usaremos la expresión <a href="https://www.mapbox.com/mapbox-gl-js/style-spec#expressions-case">Case</a>, que tiene
esta forma:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[&quot;case&quot;,
    &lt;condicion_1&gt;, &lt;salida_1&gt;,
    &lt;condicion_2&gt;, &lt;salida_2&gt;,
    ...,
    &lt;salida_por_defecto&gt;
]
</pre></div>
</td></tr></table>

<p>En nuestro caso la usaremos para decir cosas como:</p>
<ul>
<li>Si "SCALERANK" es menor que 2, aplica un tamaño de letra 20,</li>
<li>Si "SCALERANK" está entre 3 y 5, aplica un tamaño de letra 14,</li>
<li>En cualquier otro caso, aplica un tamaño de letra 10</li>
</ul>
<p>Que quedaría expresado así:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;case&quot;</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">,[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]],</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">20</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">,[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]],</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">14</span><span class="p">,</span>
  <span class="mi">10</span>
<span class="p">]</span>
</pre></div>
</td></tr></table>

<p>El operador <code>"number"</code> se usa para convertir el valor <code>SCALERANK</code> a un tipo numérico.</p>
<p>Y la combinaremos con la expresión <a href="https://www.mapbox.com/mapbox-gl-js/style-spec#expressions-step">Step</a>, que tiene
esta forma:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[&quot;step&quot;,
    &lt;entrada&gt;, &lt;salida_inicial&gt;,
    &lt;umbral_1&gt;, &lt;salida_1&gt;,
    &lt;umbral_2&gt;, &lt;salida_2&gt;,
    ...
]
</pre></div>
</td></tr></table>

<p>En nuestro caso la podemos usar para decir cosas como:</p>
<ul>
<li>Usa un tamaño de letra 18 para zooms por debajo de 5.</li>
<li>Usa un tamaño de letra 20 entre el zoom 5 y 8.</li>
<li>Usa un tamaño de letra 24 para zooms mayores que 8.</li>
</ul>
<p>Que quedaría:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">18</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">,</span> <span class="mi">24</span>
<span class="p">]</span>
</pre></div>
</td></tr></table>

<p>Obviamente podemos combinar ambas expresiones, de forma que la salida para cada nivel de zoom no sea un tamaño de
 letra concreto, sino que dependa de "SCALERANK". Y nos queda el siguiente monstruo para el Layer:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ciudades&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;naturalearth&quot;</span><span class="p">,</span>
    <span class="nt">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;cities&quot;</span><span class="p">,</span>
    <span class="nt">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;text-field&quot;</span><span class="p">:</span> <span class="s2">&quot;{NAME}&quot;</span><span class="p">,</span>
        <span class="nt">&quot;text-anchor&quot;</span><span class="p">:</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="nt">&quot;text-offset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">-1</span><span class="p">],</span>
        <span class="nt">&quot;text-size&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span>
            <span class="p">[</span>
              <span class="s2">&quot;case&quot;</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]],</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">18</span><span class="p">,</span>
              <span class="mi">0</span>
            <span class="p">],</span>
            <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;case&quot;</span><span class="p">,</span>
                  <span class="p">[</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">,[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]],</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">20</span><span class="p">,</span>
                  <span class="p">[</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">,[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]],</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">14</span><span class="p">,</span>
                  <span class="mi">10</span>
               <span class="p">],</span>
            <span class="mi">8</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;case&quot;</span><span class="p">,</span>
                  <span class="p">[</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">,[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]],</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">24</span><span class="p">,</span>
                  <span class="p">[</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">,[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]],</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">18</span><span class="p">,</span>
                  <span class="mi">14</span>
               <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;text-halo-color&quot;</span><span class="p">:</span> <span class="s2">&quot;rgba(253, 253, 253, 1)&quot;</span><span class="p">,</span>
        <span class="nt">&quot;text-color&quot;</span><span class="p">:</span> <span class="s2">&quot;rgba(16, 16, 16, 1)&quot;</span><span class="p">,</span>
        <span class="nt">&quot;text-halo-width&quot;</span><span class="p">:</span> <span class="mf">1.5</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Como se puede observar, las expresiones son tan potentes como difíciles de escribir bien a la primera.</p>
<h4 id="estilo-basado-en-una-propiedad">Estilo basado en una propiedad</h4>
<p>Vamos a crear un nuevo <code>layer</code> llamado <code>ciudades-circle</code>, y la vamos a definir a continuación de <code>ciudades</code>
y justo antes de <code>aeropuertos</code>. Dibujaremos un círculo cuyo tamaño será inversamente proporcional a la
propiedad <code>SCALERANK</code>.</p>
<p>Además, las capitales estatales se simbolizarán como un círculo blanco con un borde grueso, y el resto de
ciudades con un círculo gris con borde más fino.</p>
<p>Usaremos la misma expresión Match que hemos visto anteriormente, aplicada a un color y a un grueso de línea.</p>
<p>Además, aplicaremos una expresión matemática <code>["-"]</code>, que resta dos valores, de manera que el tamaño del círculo
será <code>10 - SCALERANK</code>: </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ciudades-circle&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
    <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;naturalearth&quot;</span><span class="p">,</span>
    <span class="nt">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;cities&quot;</span><span class="p">,</span>
    <span class="nt">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;circle-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;match&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;ADM0CAP&quot;</span><span class="p">],</span>
            <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;#888&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#FFF&quot;</span>
        <span class="p">],</span>
        <span class="nt">&quot;circle-stroke-width&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;match&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;ADM0CAP&quot;</span><span class="p">],</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
            <span class="mi">2</span>
        <span class="p">],</span>
        <span class="nt">&quot;circle-radius&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALERANK&quot;</span><span class="p">]]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="uso-de-fuentes-de-datos-externas">Uso de fuentes de datos externas</h2>
<p>Por último, vamos a añadir un fondo raster al mapa, procedente de otro tileserver.</p>
<ul>
<li>Añadiremos un nuevo <code>source</code> de tipo <code>raster</code>, a continuación del source <code>naturalearth</code>:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="s2">&quot;sources&quot;</span><span class="err">:</span> <span class="p">{</span>
  <span class="nt">&quot;naturalearth&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;vector&quot;</span><span class="p">,</span>
    <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:8081/data/natural_earth.json&quot;</span>
  <span class="p">},</span>
<span class="hll">  <span class="nt">&quot;relief&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;raster&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;tiles&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;http://naturalearthtiles.lukasmartinelli.ch/tiles/natural_earth_2_shaded_relief.raster/{z}/{x}/{y}.png&quot;</span><span class="p">],</span>
</span><span class="hll">    <span class="nt">&quot;tileSize&quot;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;maxzoom&quot;</span><span class="p">:</span> <span class="mi">6</span>
</span><span class="hll">  <span class="p">}</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table>

<ul>
<li>Borraremos el <code>layer</code> llamado <code>tierra</code>.</li>
<li>Añadiremos un nuevo <code>layer</code> justo después del <code>fondo</code> que se llamará <code>terreno</code>:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;terreno&quot;</span><span class="p">,</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;raster&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;relief&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>El resultado final de aplicar todos estos estilos tendrá este aspecto:</p>
<p><img alt="Natural Earth Final" src="../img/natural_earth_final.png" /></p>
<h3 id="ejercicio-extra-uso-de-una-fuente-con-iconos-para-simbolizar-un-punto">Ejercicio extra: uso de una fuente con iconos para simbolizar un punto</h3>
<p>Si se ha hecho el ejercicio extra del apartado anterior, en el que creábamos una fuente
a partir de una colección de iconos, ahora veremos cómo utilizarla en el Layer de
aeropuertos:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;aeropuertos&quot;</span><span class="p">,</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;naturalearth&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;airports&quot;</span><span class="p">,</span>
  <span class="nt">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="hll">    <span class="nt">&quot;icon-image&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;text-font&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Geostart Regular&quot;</span><span class="p">],</span>
</span><span class="hll">    <span class="nt">&quot;text-size&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;text-field&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span>
</span>  <span class="p">},</span>
<span class="hll">  <span class="nt">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">    <span class="nt">&quot;text-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#fabada&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;text-halo-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#888&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;text-halo-width&quot;</span><span class="p">:</span> <span class="mi">2</span>
</span><span class="hll">  <span class="p">}</span>
</span><span class="hll"><span class="p">}</span>
</span></pre></div>
</td></tr></table>

<p>En las líneas destacadas se observa cómo no se usa una <code>icon-image</code>, sino una etiqueta de texto (<code>text-font</code>, <code>text-size</code>
y <code>text-field</code>). En <code>text-field</code> se indica una coma <code>","</code>, que corresponde al icono que queremos mostrar.
Al tratarse de una fuente, podemos indicar el tamaño que queramos sin miedo a obtener una imagen pixelada,
y aplicar otras propiedades como escoger color, halo, etc.</p>
<p>Como resultado del estilo indicado se simbolizarían los aeropuertos así:</p>
<p><img alt="Aeropuerto" src="../img/aeropuerto_icon.png" /></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../5_sprites_glyphs/" title="5. Sprites y Glyphs" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                5. Sprites y Glyphs
              </span>
            </div>
          </a>
        
        
          <a href="../7_servidor_dinamico/" title="7. Cómo servir datos dinámicos" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                7. Cómo servir datos dinámicos
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>